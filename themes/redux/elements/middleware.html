<h2>Middleware</h2>

<ul class="list-point">
    <li><u-text-define>Middleware</u-text-define> - (посредник) — функция, которая вызывается при передаче действия ещё до того, как это действие попадёт в <u>reducer</u> и <u>store.</u></li>
    <li>Активировать middleware можно с помощью Redux функции applyMiddleware. Она берёт middleware, которое мы хотим зарегистрировать, и возвращает функцию, которая, в свою очередь, берёт функцию createStore. Затем эта вторая функция создаёт для нас store с уже включённым в него middleware</li>

    <hr>
    <li><u>Middleware</u> - шаблонный способ подцепления к actions, отправляемым в redux store</li>
    <li><u>Middleware</u> - функция, принимающая state и возвращающая функцию</li>
    <li><u>Middleware</u> - функции, которые перехватывают действия</li>

    <hr>
    <li>Суть middleware функций, взять входные данные, добавить что-то и передать дальше. Middleware - это всегда функция, которые обычно возвращают функцию, если только целью middleware не является прервать цепочку вызовов</li>
    <li><u>Применение: </u>от логгирование, обработка исключений, модифицирование действий, кэширование результатов и изменения способа и времени попадания действия в store</li>
</ul>

<v-code lang="js border" title="">
const starterMiddleware = store => next => action => {
    // action           => { type: "NAME", payload: "Tony" }  - Action
    // state.getState() => { reducerStarter: { name: "" } }   - Prev State

    // Вызывается Reducer
    const newState = next(action);
    
    // state.getState() => { reducerStarter: { name: "Tony" } }   - New State

    return newState;
}
</v-code>

<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3>Варианты записи</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<v-two-code type="js border;js border" comment="Стрелочная фукнкция;Обычная функция">
<template v-slot:first>
const starterMiddleware = store => next => action => {
    //
    return next(action)
}
</template>
<template v-slot:last>
const logger = (state) => {
    return function (next) {
        return function (action) {
        	//
        	return next(action)
        }
    }
}
</template>
</v-two-code>

<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<h3>Реализация Middleware Logger</h3>
<!-- xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx -->
<v-code lang="js" title="">
const logger = (state) => {
    return function (next) {
        return function (action) {
            console.log('Action', action);
            console.log('Prev State', state.getState());

            const newState = next(action);
            console.log('New State', state.getState());
            return newState;
        }
    }
}
</v-code>


